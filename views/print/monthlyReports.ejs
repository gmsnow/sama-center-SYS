<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ</title>
  <style>
    body {
      font-family: 'Tahoma', sans-serif;
      direction: rtl;
      margin: 20px;
      background: #fff;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    .header .logo img { height: 80px; }

    .header .title { text-align: center; flex: 1; }

    .header .title h1 {
      background: #b7f59e;
      padding: 10px;
      font-size: 22px;
      color: #800000;
      border: 2px solid #4e832b;
      display: inline-block;
      box-shadow: 2px 2px 5px #ccc;
    }

    .header .center-name {
      text-align: left;
      font-size: 18px;
      line-height: 1.4;
      color: #003366;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 16px;
    }

    th, td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
    }

    thead th {
      background: #d9eaf7;
      font-weight: bold;
    }

    /* ğŸŸ¢ Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø®Ù„ÙÙŠØ© Ù„Ù„ØµÙÙˆÙ */
    .week-1 { background-color: #e9f7e9; }  /* Ø£Ø®Ø¶Ø± ÙØ§ØªØ­ */
    .week-2 { background-color: #e9f0f9; }  /* Ø£Ø²Ø±Ù‚ ÙØ§ØªØ­ */
    .week-3 { background-color: #fff4e5; }  /* Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ ÙØ§ØªØ­ */
    .week-4 { background-color: #fdeaea; }  /* Ø£Ø­Ù…Ø± ÙØ§ØªØ­ */
    .week-5 { background-color: #f3e5f5; }  /* Ø¨Ù†ÙØ³Ø¬ÙŠ ÙØ§ØªØ­ */

    /* ğŸŸ¡ Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… */
    .number-red { color: #cc0000; font-weight: bold; }
    .number-green { color: green; font-weight: bold; }
    .number-blue { color: #003366; font-weight: bold; }
    .number-purple { color: purple; font-weight: bold; }

    /* ØµÙ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ */
    .total-row th {
      background: #f7f7f7;
      font-size: 18px;
    }

    .bg-orange { background: #fdd6b5; }
    .bg-green { background: #d4edc9; }
    .bg-blue { background: #d9eaf7; }

    @media print {
      * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
    }
  </style>
</head>
<body>

  <div class="header">
    <div class="logo">
      <img src="/assets/img/logos/center.png" alt="Logo">
    </div>
    <div class="title">
      <h1>
        Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ø´Ù‡Ø± 
        <%= monthName %> 
        Ù„Ù„Ø¹Ø§Ù… 
        <%= year %>Ù…
      </h1>
    </div>
    <div class="center-name">
      Ù…Ø±ÙƒØ² Ø³Ù…Ø§<br>
      Ù„Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ<br>
      ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ£Ù‡ÙŠÙ„
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>Ù…</th>
        <th class="bg-orange">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th>
        <th class="bg-blue">Ù…Ù†</th>
        <th class="bg-blue">Ø¥Ù„Ù‰</th>
        <th class="bg-green">Ø§Ù„ÙˆØ§Ø±Ø¯</th>
        <th class="bg-orange">Ø§Ù„ØµØ§Ø¯Ø±</th>
        <th class="bg-gray">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ØµØ§Ø¯Ø±</th>
      </tr>
    </thead>
    <tbody>
      <% if (weeklyData.length === 0) { %>
        <tr>
          <td colspan="7" class="text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</td>
        </tr>
      <% } else { %>
        <% weeklyData.forEach((week) => { %>
          <tr class="week-<%= week.weekNumber %>">
            <td><%= week.weekNumber %></td>
            <td>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ <%= week.weekNumber %></td>
            <td><%= week.startDate %></td>
            <td><%= week.endDate %></td>
            <td class="number-blue"><%= week.totalIncome %></td>
            <td class="number-red"><%= week.totalExpense %></td>
            <td class="number-purple"><%= week.net %></td>
          </tr>
        <% }) %>
      <% } %>
    </tbody>
    <tfoot>
      <tr class="total-row">
        <th colspan="4" class="bg-blue">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
        <th class="number-blue">
          <%= weeklyData.reduce((acc, w) => acc + w.totalIncome, 0) %>
        </th>
        <th class="number-red">
          <%= weeklyData.reduce((acc, w) => acc + w.totalExpense, 0) %>
        </th>
        <th class="number-purple">
          <%= weeklyData.reduce((acc, w) => acc + w.net, 0) %>
        </th>
      </tr>
    </tfoot>
  </table>
  <script>
    window.onload = function() {
      window.print();
    };
  </script>
</body>
</html>
